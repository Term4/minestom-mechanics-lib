package com.minestom.mechanics.systems.health.tags;

import com.minestom.mechanics.systems.ConfigTagWrapper;
import org.jetbrains.annotations.Nullable;

import java.util.List;

/**
 * Wrapper for InvulnerabilityTagValue that properly implements ConfigTagWrapper.
 * This allows the tag system to work with MULTIPLIER, MODIFY, and CUSTOM fields.
 * 
 * Usage:
 * <pre>
 * import static InvulnerabilityTagWrapper.*;
 * 
 * // Custom config (complete override: item > player > world > server)
 * player.setTag(HealthSystem.INVULNERABILITY, invulnSet(InvulnerabilityTagValue.invulnTicks(20)))
 * world.setTag(HealthSystem.INVULNERABILITY, invulnSet(InvulnerabilityTagValue.replacementEnabled(true)))
 * 
 * // Presets
 * player.setTag(HealthSystem.INVULNERABILITY, NO_INVULNERABILITY)
 * world.setTag(HealthSystem.INVULNERABILITY, LONG_INVULNERABILITY)
 * </pre>
 */
public record InvulnerabilityTagWrapper(
        @Nullable List<Double> multiplier,
        @Nullable List<Double> modify,
        @Nullable InvulnerabilityTagValue custom
) implements ConfigTagWrapper<InvulnerabilityTagValue> {
    
    // ===========================
    // STATIC FACTORY METHODS
    // ===========================
    
    /**
     * Create a custom config wrapper (complete override)
     * Priority: item > player > world > server default
     */
    public static InvulnerabilityTagWrapper invulnSet(InvulnerabilityTagValue custom) {
        return new InvulnerabilityTagWrapper(null, null, custom);
    }
    
    // ===========================
    // CHAINABLE METHODS
    // ===========================
    
    /**
     * Chain: set custom config (returns new record)
     */
    public InvulnerabilityTagWrapper thenSet(InvulnerabilityTagValue custom) {
        return new InvulnerabilityTagWrapper(this.multiplier, this.modify, custom);
    }
    
    // ===========================
    // COMMON PRESETS
    // ===========================
    
    /** No invulnerability (0 ticks) */
    public static final InvulnerabilityTagWrapper NO_INVULNERABILITY = 
            invulnSet(InvulnerabilityTagValue.invulnTicks(0));
    
    /** Standard invulnerability (10 ticks) */
    public static final InvulnerabilityTagWrapper STANDARD = 
            invulnSet(InvulnerabilityTagValue.invulnTicks(10));
    
    /** Long invulnerability (20 ticks) */
    public static final InvulnerabilityTagWrapper LONG_INVULNERABILITY = 
            invulnSet(InvulnerabilityTagValue.invulnTicks(20));
    
    /** Damage replacement enabled */
    public static final InvulnerabilityTagWrapper REPLACEMENT_ENABLED = 
            invulnSet(InvulnerabilityTagValue.replacementEnabled(true));
    
    /** Damage replacement disabled */
    public static final InvulnerabilityTagWrapper REPLACEMENT_DISABLED = 
            invulnSet(InvulnerabilityTagValue.replacementEnabled(false));
    
    // ===========================
    // ConfigTagWrapper INTERFACE
    // ===========================
    
    @Override
    public List<Double> getMultiplier() {
        // Invulnerability doesn't use multipliers
        return null;
    }
    
    @Override
    public List<Double> getModify() {
        // Invulnerability doesn't use modify
        return null;
    }
    
    @Override
    public InvulnerabilityTagValue getCustom() {
        return custom;
    }
}

