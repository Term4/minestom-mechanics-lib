package com.minestom.mechanics.systems.health.tags;

import com.minestom.mechanics.systems.ConfigTagWrapper;
import org.jetbrains.annotations.Nullable;

import java.util.List;

/**
 * Tag value for invulnerability configuration.
 * Supports custom invulnerability ticks, damage replacement settings, etc.
 * 
 * Usage:
 * <pre>
 * import static InvulnerabilityTagValue.*;
 * 
 * // Set custom invulnerability ticks
 * entity.setTag(HealthSystem.INVULNERABILITY_TICKS, invulnTicks(20))
 * 
 * // Disable invulnerability
 * entity.setTag(HealthSystem.INVULNERABILITY_TICKS, invulnTicks(0))
 * 
 * // Enable/disable damage replacement
 * entity.setTag(HealthSystem.DAMAGE_REPLACEMENT, replacementEnabled(true))
 * </pre>
 */
public record InvulnerabilityTagValue(
        @Nullable Integer invulnerabilityTicks,
        @Nullable Boolean damageReplacementEnabled,
        @Nullable Boolean knockbackOnReplacement,
        @Nullable Boolean bypassInvulnerability,
        @Nullable Boolean bypassCreativeInvulnerability,
        @Nullable Boolean bypassCreativeMelee
) implements ConfigTagWrapper<InvulnerabilityTagValue> {
    
    // ===========================
    // STATIC FACTORY METHODS
    // ===========================
    
    /**
     * Create an invulnerability ticks tag value
     */
    public static InvulnerabilityTagValue invulnTicks(int ticks) {
        return new InvulnerabilityTagValue(ticks, null, null, null, null, null);
    }

    /**
     * Create a damage replacement enabled tag value
     */
    public static InvulnerabilityTagValue replacementEnabled(boolean enabled) {
        return new InvulnerabilityTagValue(null, enabled, null, null, null, null);
    }

    /**
     * Create a knockback on replacement tag value
     */
    public static InvulnerabilityTagValue knockbackOnReplacement(boolean enabled) {
        return new InvulnerabilityTagValue(null, null, enabled, null, null, null);
    }

    /**
     * Create a bypass invulnerability tag value (weapon/attacker bypasses i-frames).
     */
    public static InvulnerabilityTagValue bypassInvulnerability(boolean bypass) {
        return new InvulnerabilityTagValue(null, null, null, bypass, null, null);
    }

    /**
     * Create a bypass creative invulnerability tag value (projectiles from this item/entity/world can hit creative players).
     */
    public static InvulnerabilityTagValue bypassCreativeInvulnerability(boolean bypass) {
        return new InvulnerabilityTagValue(null, null, null, null, bypass, null);
    }

    /**
     * Create a bypass creative melee tag value (melee attacks with this item/entity can hit creative players).
     */
    public static InvulnerabilityTagValue bypassCreativeMelee(boolean bypass) {
        return new InvulnerabilityTagValue(null, null, null, null, null, bypass);
    }

    /**
     * Create a combined tag value
     */
    public static InvulnerabilityTagValue invulnConfig(int ticks, boolean replacementEnabled, boolean knockbackOnReplacement) {
        return new InvulnerabilityTagValue(ticks, replacementEnabled, knockbackOnReplacement, null, null, null);
    }
    
    // ===========================
    // CHAINABLE METHODS
    // ===========================
    
    /**
     * Chain: set invulnerability ticks
     */
    public InvulnerabilityTagValue thenTicks(int ticks) {
        return new InvulnerabilityTagValue(ticks, this.damageReplacementEnabled, this.knockbackOnReplacement, this.bypassInvulnerability, this.bypassCreativeInvulnerability, this.bypassCreativeMelee);
    }

    /**
     * Chain: set damage replacement
     */
    public InvulnerabilityTagValue thenReplacement(boolean enabled) {
        return new InvulnerabilityTagValue(this.invulnerabilityTicks, enabled, this.knockbackOnReplacement, this.bypassInvulnerability, this.bypassCreativeInvulnerability, this.bypassCreativeMelee);
    }

    /**
     * Chain: set knockback on replacement
     */
    public InvulnerabilityTagValue thenKnockback(boolean enabled) {
        return new InvulnerabilityTagValue(this.invulnerabilityTicks, this.damageReplacementEnabled, enabled, this.bypassInvulnerability, this.bypassCreativeInvulnerability, this.bypassCreativeMelee);
    }

    /**
     * Chain: set bypass invulnerability
     */
    public InvulnerabilityTagValue thenBypassInvulnerability(boolean bypass) {
        return new InvulnerabilityTagValue(this.invulnerabilityTicks, this.damageReplacementEnabled, this.knockbackOnReplacement, bypass, this.bypassCreativeInvulnerability, this.bypassCreativeMelee);
    }

    /**
     * Chain: set bypass creative invulnerability (projectiles)
     */
    public InvulnerabilityTagValue thenBypassCreativeInvulnerability(boolean bypass) {
        return new InvulnerabilityTagValue(this.invulnerabilityTicks, this.damageReplacementEnabled, this.knockbackOnReplacement, this.bypassInvulnerability, bypass, this.bypassCreativeMelee);
    }

    /**
     * Chain: set bypass creative melee (melee attacks can hit creative players)
     */
    public InvulnerabilityTagValue thenBypassCreativeMelee(boolean bypass) {
        return new InvulnerabilityTagValue(this.invulnerabilityTicks, this.damageReplacementEnabled, this.knockbackOnReplacement, this.bypassInvulnerability, this.bypassCreativeInvulnerability, bypass);
    }
    
    // ===========================
    // COMMON PRESETS
    // ===========================
    
    /** No invulnerability */
    public static final InvulnerabilityTagValue NO_INVULNERABILITY = invulnTicks(0);
    
    /** Standard invulnerability (10 ticks) */
    public static final InvulnerabilityTagValue STANDARD = invulnTicks(10);
    
    /** Long invulnerability (20 ticks) */
    public static final InvulnerabilityTagValue LONG = invulnTicks(20);
    
    /** Damage replacement enabled */
    public static final InvulnerabilityTagValue REPLACEMENT_ENABLED = replacementEnabled(true);
    
    /** Damage replacement disabled */
    public static final InvulnerabilityTagValue REPLACEMENT_DISABLED = replacementEnabled(false);

    /** Weapon/attacker bypasses invulnerability */
    public static final InvulnerabilityTagValue BYPASS_INVULNERABILITY = bypassInvulnerability(true);

    /** Projectiles from this item/entity/world can hit creative players */
    public static final InvulnerabilityTagValue BYPASS_CREATIVE = bypassCreativeInvulnerability(true);

    /** Melee attacks with this item/entity can hit creative players */
    public static final InvulnerabilityTagValue BYPASS_CREATIVE_MELEE = bypassCreativeMelee(true);
    
    // ===========================
    // ConfigTagWrapper INTERFACE
    // ===========================
    
    @Override
    public List<Double> getMultiplier() {
        // Invulnerability doesn't use multipliers
        return null;
    }
    
    @Override
    public List<Double> getModify() {
        // Invulnerability doesn't use modify
        return null;
    }
    
    @Override
    public InvulnerabilityTagValue getCustom() {
        // Return self as custom config
        return this;
    }
}


